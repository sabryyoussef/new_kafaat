<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
        
        <!-- Record Rule: Sales Reps see only contacts from their assigned pools -->
        <record id="res_partner_salesperson_rule" model="ir.rule">
            <field name="name">Contacts: Salesperson Pool Access</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">[
                '|', '|',
                ('pool_id.sales_person_id', '=', user.id),
                ('pool_id.sales_person_id', '=', False),
                ('id', '=', user.partner_id.id)
            ]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <!-- Record Rule: Sales Reps see only leads linked to their pool contacts -->
        <record id="crm_lead_salesperson_rule" model="ir.rule">
            <field name="name">Leads: Salesperson Pool Access</field>
            <field name="model_id" ref="crm.model_crm_lead"/>
            <field name="domain_force">[
                '|',
                ('partner_id.pool_id.sales_person_id', '=', user.id),
                ('partner_id.pool_id.sales_person_id', '=', False)
            ]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
        <!-- Record Rule: Sales Reps see only pools where they are assigned -->
        <record id="contact_pool_salesperson_rule" model="ir.rule">
            <field name="name">Contact Pool: Salesperson Access</field>
            <field name="model_id" ref="grants_training_suite_v19.model_contact_pool"/>
            <field name="domain_force">[
                '|',
                ('sales_person_id', '=', user.id),
                ('sales_person_id', '=', False)
            ]</field>
            <field name="groups" eval="[(4, ref('sales_team.group_sale_salesman'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
        
    </data>
</odoo>

